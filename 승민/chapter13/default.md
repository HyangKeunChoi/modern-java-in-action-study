### 13
# 디폴트 메서드

- 주로 라이브러리 설계자들이 사용함
- 디폴트 메서드가 없던 시절에는 인터페이스에 메서드를 추가하면서 여러 문제가 있었다.
- 새로 추가된 메서드를 구현하도록 인터페이스를 구현하는 기존 클래스를 고쳐야하기 때문
- 디폴트 메서드를 이용하면 인터페이스의 기본 구현을 그대로 상속하므로 인터페이스에 자유롭게 새로운 메서드를 추가할 수 있게 된다.

- Resizeable사례
```java
public interface Resizeable extends Drawable {
    int getWidth();
    int getHeight();
    void setWidth(int width);
    void setHeight(int hegiht);
    void setAbsoluteSize(int width, int height);
}

//사용자의 구현
public class Ellipse implements Resizeable{
    ...
}

// 사용자들의 요청으로 Resizeable에 API2 버전이 나오게된다.
void setRelativeSize()
```

- Resizeable 1버전으로 구현한 모든 클래스는 setRelativeSize를 구현해야하는 문제가 발생한다. 
- 인터페이스에 새로운 메서드를 추가하면 바이너리 호환성은 유지된다 (호출만 하지 않으면 기존 클래스 파일이 잘 동작한다.)
- 누군가 Ellipse에서 setRelativeSize 를 사용하도록 한다면 오류가 발생한다.
- 디폴트 메서드를 이용하여 API를 바꾸면 새롭게 바뀐 인터페이스에서 자동으로 기본 구현을 제공하므로 기존 코드를 고치지 않아도된다.

# 디폴트 메서드란 무엇인가?
- default 라는 키워드를 시작하며 다른 클래스에 선언된 메서드 바디를 포함한다.
- 컬렉션 라이브러리에 Sized라는 인터페이스를 정의했다고 가정한다.
```java
public interface Sized{
    int size();
    default boolean isEmpty(){ //디폴트 메서드
        return size() == 0 ;
    }
}
```

- Sized 인터페이스를 구현하는 모든 클래스는 isEmpty 의 구현도 상속받는다.

# 다중 상속
- ArrayList는 한개의 클래스를 상속받고 6개의 인터페이스를 구현한다.

# 옳지 못한 상속
 - 한 개의 메서드를 재사용하려고 100개의 메서드와 필드가 정의되어있는 클래스를 상속받는 것은 좋은 생각이 아니다.
 - 델리게이션 (멤버변수)를 이용하여 클래스에 필요한 메서드를 직접 호출하는 메서드를 작성하는 것이 좋다.
 - final을 이용하여 핵심 기능을 바꾸지 못하도록 제한 할 수 있다.

 # 해석 규칙
 - 자바의 클래스는 하나의 부모 클래스만 상속 받을 수 있지만 여러 인터페이스를 동시에 구현 할 수 있다.
    - 클래스가 항상 이긴다. 클래스나 슈퍼클래스에서 정의한 메서드가 디폴트 메서보다 우선권을 가진다.
    - 1번 규칙 이외의 상황에서는 서브인터페이스가 이긴다. 상속 관계를 갖는 인터페이스에서 같은 시그니처를 갖는 메서드를 정의할때는 서브인터페이스가 이긴다.
    즉 B가 A를 상속 받는다면 B가 A를 이긴다.
    - 여전히 디폴트 메서드의 우선순위가 결정되지 않았다면 여러 인터페이스를 상속받는 클래스가 명시작으로 디폴트 메서드를 오버라이드하고 호출해야한다.

# 마치며
- 자바 8의 인터페이스는 구현 코드를 포함하는 디폴트 메서드, 정적 메서드를 정의할 수 있다.
- 디폴트 메서드 정의는 default 키워드로 시작하며 일반 클래스처럼 바디를 갖는다.
- 공개된 인터페이스에 추상메서드를 추가하면 소스 호환성이 깨진다.
- 디폴트 메서드 덕분에 라이브러리 설계자가 API를 바꿔도 기존 버전과 호환성을 유지할 수 있다.
- 선택형 메서드와 동작 다중 상속에도 디폴트 메서드를 사용할 수 있다.
- 클래스가 같은 시그니처를 갖는 여러 디폴트 메서드를 상속하면서 생기는 충돌 문제를 해결하는 규칙이 있다.
-  클래스나 슈퍼클래스에 정의된 메서드가 다른 디폴트 메서드 정의보다 우선한다.
- 이외의 상황에서는 서브인터페이스에서 제공하는 디폴트 메서드가 선택된다.
- 두 메서드의 시그니처가 같고, 상속관계로도 충돌 문제를 해결 할수 없다면 오버라이드해서 어떤 디폴트 메서드를 호출할지 명시적으로 결정해야한다.
















