4.1 스트림이란 무엇인가?
- 스트림을 이용하면 선언형(즉, 데이터를 처리하는 임시 구현 코드 대신 질의로 표현할 수 있다)으로 컬렉션 데이터를 처리할 수 있다.
- 멀티스레드 코드를 구현하지 않아도 데이터를 투명하게 병렬로 처리할 수 있다.

- filter (또는 sorted, map, collect) 같은 연산은 '고수준 빌딩 블록'으로 이루어져 있으므로 특정 스레딩 모델에 제한되지 않고 자유롭게 어떤 상황에서든 사용할 수 있다.


- 스트림 연산을 연결해서 스트림 파이프라인 형성
- 그림과 같이 filter, sorted, map, collect 같은 여러 빌딩 블록 연산을 연결해서 복잡한 데이터 처리 파이프라인을 만들 수 있다.
  여러 연산을 파이프라인으로 연결해도 여전히 가독성과 명확성이 유지된다.
  filter 메서드의 결과는 sorted 메서드로, 다시 sorted 결과는 map 메서드로, map 메서드의 결과는 collect로 연결된다.
  
  <img width="224" alt="image" src="https://user-images.githubusercontent.com/105032845/173594999-911aad01-6a67-43ee-9364-0835e9185818.png">


* 자바8의 스트림 API의 특징을 다음처럼 요약할 수 있다.
  - 선언형 : 더 간결하고 가독성이 좋아진다.
  - 조립할 수 있음 : 유연성이 좋아진다.
  - 병렬화 : 성능이 좋아진다.


4.2 스트림 시작하기
 - 스트림이란 정확히 뭘까? 스트림이란 '데이터 처리 연산을 지원하도록 소스에서 추출된 연속된 요소'로 정의할 수 있다.

1. 연속된 요소
 - 컬렉션과 마찬가지로 스트림은 특정 요소 형식으로 이루어진 연속된 값 집합의 인터페이스를 제공
2. 소스
 - 스트림은 컬렉션, 배열, I/O 자원 등의 데이터 제공 소스로부터 데이터를 소비한다.
 - 정렬된 컬렉션으로 스트림을 생성하면 정렬이 그대로 유지된다.
3. 데이터 처리 연산
 - 스트림은 함수형 프로그래밍 언어에서 일반적으로 지원하는 연산과 데이터베이스와 비슷한 연산을 지원한다.
   예를들어 filter, map, reduce, find, match, sort 등으로 데이터를 조작할 수 있다.
4. 파이프라이닝
 - 대부분의 스트림 연산은 스트림 연산끼리 연결해서 커다란 파이프 라인을 구성할 수 있도록 스트림 자신을 반환한다. 그 덕분에 게으름, 쇼트서킷같은 최적화도 얻을 수 있다.
5. 내부 반복
 - 반복자를 이용해서 명시적으로 반복하는 컬렉션과 달리 스트림은 내부 반복을 지원한다.

4.3.1 딱 한 번만 탐색할 수 있다.
- 반복자와 마찬가지로 스트림도 한 번만 탐색할 수 있다.
  즉, 탐색된 스트림의 요소는 소비된다.
  반복자와 마찬가지로 한 번 탐색한 요소를 다시 탐색하려면 초기 데이터 소스에서 새로운 스트림을 만들어야 한다.
  
List<String> title = Arrays.asList("Java8", "In", "Action");
Stream<String> s = title.stream();
s.forEach(System.put:println); -> title의 각 단어를 출력
s.forEach(System.put:println); -> java.lang.IllegalStateException:스트림이 이미 소비되었거나 닫힘
 * 스트림은 단 한 번만 소비할 수 있다는 점을 명심하자!
  
4.3.2 외부 반복과 내부 반복
  - 컬렉션 인터페이스를 사용하려면 사용자가 직접 요소를 반복해야 한다.(예를 들면 for-each를 사용) 이를 외부 반복 이라고 한다.
  - 스트림 라이브러리는(반복을 알아서 처리하고 결과 스트림값을 어딘가에 저장)내부 반복을 사용한다.
  
* 외부반복
  List<String> names = new ArrayList<>();
  for(Dish dish: menu) { // 메뉴 리스트를 명시적으로 순차 반복한다.
    names.add(dish.getName()); // 이름을 추출해서 리스트에 추가한다.
  }
  
* 내부반복
  List<String> names = menu.stream()
                      .map(Dish::getName) // map 메서드를 getName 메서드로 파라미터화해서 요리명을 추출한다.
                      .collect(toList());
4.4.3 스트림 이용하기
 - 스트림 이용 과정은 다음고 같이 세 가지로 요약할 수 있다.
   1. 질의를 수행할 (컬렉션 같은) 데이터 소스
   2. 스트림 파이프라인을 구성할 중간 연산 연결
   3. 스트림 파이프라인을 실행하고 결과를 만들 최종 연산
  
4.6 마치며
  - 스트림은 소스에서 추출된 연속 요소로, 데이터 처리 연산을 지원한다.
  - 스트림은 내부 반복을 지원한다. 내부 반복은 filter, map, sorted 등의 연산으로 반복을 추상화한다.
  - 스트림에는 중간 연산과 최종 연산이 있다.
  - 중간 연산은 filter와 map처럼 스트림을 반환하면서 다른 연산과 연결되는 연산이다.
    중간 연산을 이용해서 파이프라인을 구성할 수 있지만 중간 연산으로는 어떤 결과도 생성할 수 없다.
  - forEach나 count처럼 스트림 파이프라인을 처리해서 스트림이 아닌 결과를 반환하는 연산을 최종 연산이라고 한다.
